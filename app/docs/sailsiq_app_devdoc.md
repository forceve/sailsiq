# SailSIQ 平台（数字产品线）MVP 设计总纲

> 核心目标：做出好用的复盘/教学工具，用最小代价验证 **“有人愿意用 + 愿意配硬件”**。


---

## 0. 一句话定位（Positioning）
- **中文**：SailSIQ 不单是轨迹播放器，而是集教学/复盘/分享功能于一身的超级工具。支持多种数据导入，支持尽可能多的帆船场景。
---

## 1. 用户与场景（Users & Use cases）

### 1.1 目标用户
- 教练（Coach）：需要快速产出讲课素材、复盘内容、可分享链接
- 竞赛/训练队员（Sailor）：想知道自己哪里慢/怎么改
- 俱乐部/训练营（Club/Camp）：想沉淀课程、统一训练流程
- 内容创作者（Content Creator）：需要将航行数据可视化叠加到视频中，制作教学/赛事/体验类内容

### 1.2 MVP 聚焦场景（必须能打通）
- 赛后复盘：导入一次航行 → 回放 → 标注关键节点 → 导出/分享
- 课堂/讲解：地图+航迹+航标+风箭头 → 跟随时间讲述战术
- 视频制作：导出透明仪表盘图层 → 叠加到视频中，增强内容专业度

> 非 MVP 场景：高精度帆船动力学、全自动战术结论、复杂风场连续插值

---

## 2. 功能拆解与优先级（P0 / P1 / P2）

### 2.1 P0（MVP 必须有：能复盘、能教学、能分享）

#### A) Session 体系（Project / Session）
- 新建项目 Project（可选）：用于组织多个 Session
- Session（一次航行）基本信息：名称、日期、地点（可自动填）、船型/队伍（可选）

#### B) 导入（Import）
- 支持格式：
  - 普通 GPX 文件：导入 .gpx
  - SailSIQ 设备 bin：导入设备导出的 .bin（二进制文件，可能包含 heading 等额外字段）
- 解析最小字段：`time, lat, lon`（可推导 speed/heading）
- **SailSIQ 设备 bin 可能包含大部分信息（如 heading、速度、航标位置、风向等），系统会自动识别并填入，减少手动输入**
- 允许缺失字段：UI 清晰显示 N/A，不阻塞使用

#### C) 地图画板 v1（Canvas v1）
- 底图：矢量/卫星切换
- 航迹：轨迹线（polyline），支持渐进绘制
- 航标/航点 Marks：添加/拖拽/命名（Start/Mark/Finish）
- 风（最简）：全局风向/风速（手动输入即可）+ 风箭头显示

#### D) 回放（Replay）
- 播放/暂停
- 倍速：1x–10x 滑块调节（颗粒度 0.1x）
- 时间轴进度条：拖动跳转到任意时间点
- 时间跳转：±10秒 / ±30秒 快捷按钮
- 回放同步：船位点移动、轨迹推进

#### E) 图表与统计 v1（Charts & Stats）
- 最少 2–3 个图：
  - Speed（SOG 估算/设备提供）
  - Heading/Course（相邻点方位角）
  - Turn rate（可选）
- 关键统计卡片：
  - Duration / Distance / Avg speed / Max speed
  - Turn count（粗略：转向次数）
- 图表联动回放：点击曲线 → 时间轴跳转

#### F) 标注（Annotations）教学核心
- 时间轴事件点 Event marker：文本备注
- 一键截图 Snapshot（画板当前状态）
- 事件列表：可跳转定位

#### G) 导出与分享（Export / Share）
- 分享链接（只读 view）或导出 PDF（最简版也行）
- **视频仪表盘导出**：可选组件分别导出透明背景视频（MP4），包括轨迹、速度、航向三个独立组件，方便用户自行在剪辑软件中排版

---

### 2.2 P1（体验加分：提升“教练效率”，但不阻塞 MVP）

#### H) 自动标红（Auto highlights v0.1）
- **路径速度渲染（Speed gradient track）**：
  - 轨迹按 `speed` 映射为渐变色（低速→高速），回放时同步“走色/渐进绘制”
  - 可选：在图例中显示 min/avg/max speed（或分位数）
- **疑似问题点标注（Timeline markers）**：
  - 系统自动生成“疑似问题点” marker 并标在时间轴上（可过滤/可分类渲染）
  - 点击 marker：时间轴跳转 + 地图定位到对应点
  - MVP 级检测规则（启发式即可）**：
    - 速度骤降（speed drop）：短窗口内 speed 明显下滑（相对阈值/分位数）
    - 转向事件（turn event）：Exit 角度过大 / Turn rate 峰值明显
- **输出原则：只是识别几种简单异常，方便快速定位**：
  - 教练可对 marker：确认/否决 + 选择原因（rudder/timing/wind/route/other）+ 添加 Comment（可选）
  - 系统保存修正，用于后续提升规则/模型（形成标签飞轮）（Concent包含在用户协议中）
- 信息保存在 Session 中可供后续查看

#### I) A/B 对比（Compare）
- 同一 Session：两条片段对比
- 或两个 Session：轨迹叠加对比

#### J) Lesson Capsule（课程胶囊）- 超高性价比卖点
- 定位：解决教练 Briefing 素材的痛点，提高教学质量，减少教练无用工作量
- 从事件点选 3–8 个
- 自动生成可滑动故事流：截图 + 关键数据 + 解释文本（原因/Comment）


#### K) 视频辅助模式（Video Overlay Mode）- 团队复盘重磅功能

- 多视频类型支持：

    - 支持导入 普通平面视频 与 360° 全景视频（如运动相机/头盔相机）

    - 视频与 Session 时间轴对齐（手动或自动校准）

- 两种显示模式（可切换）：

    1. 视频叠加模式（Overlay）：在视频画面上叠加高对比度数据仪表（速度、航向、时间、关键指标等），适合沉浸式观看与讲解动作细节。

    2. 分屏对照模式（Split View）：页面左右或上下分屏：一侧为视频，另一侧为数据与画板，两边时间对齐同步操作。数据侧功能与常规 Canvas 一致（航迹、航标、风、时间轴），适合战术讲解与视频动作的同步对照。

- 360° 视频交互：支持视角拖动

#### L) 基础云服务（Basic Online Service）
- 保存航迹/文字等轻量内容到云端（视频待定）
- 可用于收集数据以便开发

---

### 2.3 P2（技术壁垒方向：做强就很难抄）
> P2 的目标：把 SailSIQ 从“轨迹/数据播放器”升级成 教练可信赖的技术/战术解释系统。

这些能力往往需要长期数据积累与工程打磨，短期难以被复制。

- 会员功能：提供完备的云服务
- 硬件日志深度接入（与 SailSiq 硬件结合打造更好的品牌生态）
- 战术语义引擎（自动切片/事件识别/事件归因/个性化）
- 风场重建（根据风力仪 + 航行数据 + POLARS 重建风场）
- 团队云空间、协作、权限、评论、作业式教学（按成本提供免费版本）
    - Team workspace：教练/队员/管理员权限（查看/评论/编辑/导出/分享），团队工作流整合（训练计划/个人档案/智能分析），云端服务
    - 评论与讨论：在事件点上评论、@队员、形成复盘记录/训练计划
    - 作业式训练：教练布置“看这 5 个事件并回答问题/打标签”，系统收集反馈作为训练数据
    - 内容库：Lesson Capsule 与 Session 版本管理，形成训练营知识沉淀与复用

---

## 3. MVP 信息架构（App IA）
### 3.1 页面清单（Pages）

1. Home / Sessions 列表
2. New Session（创建/加载 GPX）
3. Replay Workspace（核心工作台）

   * Map Canvas
   * Timeline
   * Charts
   * Events panel
4. Export / Share
5. Settings（含 Data & Privacy）

### 3.2 核心工作台布局（Workspace layout）

* 左：事件/航标列表（Events & Marks）
* 中：画板地图（Canvas）
* 右：曲线/统计（Charts & Stats）
* 底：时间轴（Timeline）

（桌面/浏览器优先，多面板体验更爽；移动端再做折叠。）

### 3.3 页面设计概要（Page Design Brief）
- **Home / Sessions 列表**
  - 列表：Session 卡片（名称/日期/来源/标记数），支持搜索/筛选。
  - 快捷入口：新建 Session（导入 / 画板）、最近打开、示例数据。
  - 状态：空列表占位（引导导入）、加载中骨架屏、错误提示。
- **New Session（创建/加载 GPX）**
  - 信息区：名称、日期、地点自动填、船型/队伍、所属 Project。
  - 数据导入区：GPX / SailSIQ bin 上传卡片，显示解析预览与字段健康度。
  - 画板模式入口：明确的“改用手动绘制”切换。
  - 辅助提示：缺失字段提示、不阻塞继续；导入成功后展示轨迹缩略图。
- **Replay Workspace（核心工作台）**
  - 左：事件列表 / 航标列表切页，支持跳转定位与过滤。
  - 中：地图画板，轨迹渐进绘制，航标/风箭头，选中点高亮。
  - 右：图表与统计卡片，曲线联动时间轴；指标卡可折叠。
  - 底：时间轴 + 播放控制（播放/暂停、倍速、±10s/±30s、拖拽跳转）。
  - 工具条：截图、一键标注、分享/导出入口。
- **Export / Share**
  - 导出选项：PDF（轨迹+事件+截图）、分享链接（只读视图）、视频仪表组件导出。
  - 预览区：PDF/分享链接预览，选择包含的事件与截图。
  - 状态：导出中进度/失败重试；链接权限提示。
- **Settings（含 Data & Privacy）**
  - 数据与隐私：数据收集开关、匿名化说明、条款链接。
  - 设备与导入：默认导入偏好（速度单位、时间格式）、设备固件版本显示。
  - 账户：语言、主题、云端登录占位（P1/P2 预留）。

---

## 4. MVP 交互流程（User Flows）

### P0 基础流程（MVP 必须）

#### Flow A：赛后复盘（导入数据路径）

1. **创建 Session - 选择数据源**
   - 从 Home 页面点击"新建 Session"
   - 选择创建方式：
     - **选项1：导入数据**（GPX 文件或 SailSIQ 设备 bin）
     - **选项2：画板模式**（手动绘制，见 Flow B）
   - 填写基本信息：名称、日期、地点（可自动识别）、船型/队伍（可选）
   - 选择所属 Project（可选）

2. **导入数据**（选择导入数据时）
   - 导入 GPX 文件或 SailSIQ 设备 bin
   - 系统自动解析：`time, lat, lon`（派生 speed/heading）
   - **SailSIQ 设备 bin 可能包含大部分信息（如 heading、速度、航标位置、风向等），系统会自动识别并填入**
   - 缺失字段显示 N/A，不阻塞使用
   - 自动生成轨迹预览

3. **补充航标与风信息**（如导入数据中缺失）
   - 在地图上添加/拖拽航标：Start、Marks、Finish
   - 手动输入全局风向/风速（如未自动识别）
   - 地图上显示风箭头

4. **回放与观察**
   - 播放/暂停控制
   - 倍速调节：1x–10x 滑块（颗粒度 0.1x）
   - 时间轴拖动跳转到任意时间点
   - 快捷按钮：±10秒 / ±30秒
   - 观察船位点移动、轨迹渐进绘制
   - 查看右侧图表：Speed、Heading/Course、Turn rate
   - 查看统计卡片：Duration、Distance、Avg/Max speed、Turn count
   - 点击图表曲线 → 时间轴自动跳转

5. **标注关键事件**
   - 在关键时刻点击"+事件"
   - 输入文本备注（一句话描述）
   - 一键截图（保存画板当前状态）
   - 事件自动添加到左侧事件列表
   - 从事件列表可快速跳转定位

6. **保存 Session**
   - 保存为 Session（可用于后续讲课）

7. **导出与分享**
   - 导出 PDF（包含轨迹、事件、截图）
   - 生成分享链接（只读视图）

#### Flow B：画板模式（手动绘制路径）

8. **创建 Session - 选择画板模式**
   - 从 Home 页面点击"新建 Session"
   - 填写基本信息：名称、日期、地点、船型/队伍（可选）
   - 选择所属 Project（可选）
   - **选择创建方式**：画板模式

9. **手动绘制轨迹**
   - 在地图上手动绘制航迹（点击/拖拽绘制路径）
   - 添加/拖拽航标：Start、Marks、Finish
   - 手动输入全局风向/风速
   - 地图上显示风箭头

10. **保存为 Session**
    - 保存为 Session（可用于后续讲课）

#### Flow C：制作/执行课程（教练）

11. **打开 Session**
    - 从 Home/Sessions 列表选择已有 Session
    - Session 来源可以是：
      - Flow A（导入数据）创建的 Session
      - Flow B（画板模式）创建的 Session

12. **准备讲解内容**
    - 查看事件列表（手动标注的事件，如有）
    - 手动选择要讲解的事件点顺序
    - 或按时间顺序自动排列

13. **演示模式**
    - 进入全屏模式（隐藏非必要 UI）
    - 地图画板 + 时间轴 + 关键数据仪表
    - 跟随时间轴讲述战术
    - 可随时跳转到特定事件点

---

### P1 增强流程

#### Flow A 增强：轨迹按速度渐变渲染 + 自动标记辅助

14. **自动识别疑似问题点**
    - 轨迹按速度渲染渐变色（低速→高速），回放时同步"走色/渐进绘制"
    - 系统自动识别：速度骤降、转向事件（tack/gybe）
    - 时间轴上显示自动生成的 marker
    - 点击 marker：时间轴跳转 + 地图定位到对应点（可高亮 5–15 秒窗口）

15. **教练修正与标签**
    - 教练可对 marker：确认/否决 + 选择原因（rudder/timing/wind/route/other）+ 添加 Comment（可选）
    - 系统保存修正，用于后续提升规则/模型（形成标签飞轮）

#### Flow A 增强：A/B 对比

16. **片段或 Session 对比**
    - 同一 Session：选择两条片段对比
    - 或两个 Session：轨迹叠加对比
    - 分屏显示，同步回放

#### Flow A 增强：视频辅助模式

17. **导入与对齐视频**
    - 导入普通平面视频或 360° 全景视频（如运动相机/头盔相机）
    - 视频与 Session 时间轴对齐（手动或自动校准）

18. **两种显示模式（可切换）**
    - **视频叠加模式（Overlay）**：在视频画面上叠加高对比度数据仪表（速度、航向、时间、关键指标等），适合沉浸式观看与讲解动作细节
    - **分屏对照模式（Split View）**：页面左右或上下分屏：一侧为视频，另一侧为数据与画板。数据侧显示效果与常规 Canvas 基本一致（航迹、航标、风、时间轴），适合战术讲解与视频动作的同步对照
    - 360° 视频交互：支持视角拖动

#### Flow C 增强：Lesson Capsule（课程胶囊）

19. **生成课程故事流**
    - 从事件点选择 3–8 个关键事件
    - 系统自动生成可滑动故事流：截图 + 关键数据 + 解释文本（原因/Comment）
    - 预览并编辑内容
    - 导出为可分享格式

#### Flow C 增强：视频辅助讲解

20. **视频模式讲解**
    - 如 Session 已关联视频，切换到视频叠加模式或分屏对照模式
    - 在视频画面上叠加数据仪表，讲解动作细节
    - 或使用分屏对照模式，同步讲解战术与动作

#### Flow C 增强：自动标红辅助讲解

21. **利用自动识别辅助讲解**
    - 利用系统自动识别的问题点 marker
    - 快速定位到疑似问题区域
    - 结合教练判断进行讲解

#### 新流程：基础云服务

22. **云端保存与同步**
    - 保存航迹/文字等轻量内容到云端
    - 可用于收集数据以便开发（需用户 opt-in）

---

## 5. 数据模型最小集合（MVP Schema）

**本段完成详细设计后再设计**

---

## 6. 轨迹清洗与性能（GPX 也要“看起来专业”）

### 6.1 必做（否则体验会崩）

* 去抖/滤波：速度曲线与位置抖动平滑（简单移动平均或更稳一点的滤波）
* 去掉静止段（港池/停船）：可设置阈值（speed < x 持续 y 秒）
* 轨迹抽稀（简化点数）：保证地图渲染与回放不卡
* 轨迹分段（upwind/downwind）

---

## 7. 数据收集与隐私（Day 1 埋下壁垒）

> 目标：建立数据飞轮，同时不伤害信任。

### 7.1 数据三层（不要“一锅端”）

* Layer 1：Raw session data（敏感高）
* Layer 2：Derived features（价值高、可匿名）
* Layer 3：Labels & corrections（最稀缺壁垒）

### 7.2 模式设计

* Private Mode（默认）：不用于训练
* Improve SailSIQ（opt-in）：导入匿名特征 + 标签修正

### 7.3 必要用户操作

* 数据使用开关（Raw/Features/Labels）
* 导出、删除

---

## 8. 开源/闭源边界（推荐路线：Open-core）

### 开源（提升 adoption）

* Canvas / Replay 引擎
* 数据点/轨迹处理模型
* 图表与标注
* Plugin API

### 闭源（护城河）

* 硬件固件与高质量日志
* 校准一致性管线
* 战术语义引擎
* 风场重建
* 团队协作与云端内容生产

### 总体原则: 应用开源，服务闭源

---

## 10. 里程碑（Milestones）

### M0：可用的轨迹回放（1 个闭环）

* GPX 导入 → 轨迹 → 回放 → 统计

### M1：可教学（教练能讲课）

* Marks + 手动风 + 事件标注 + 截图

### M2：可分享（传播与转化）

* 分享链接 / PDF
* Lesson Capsule（推荐）

### M3：飞轮启动（壁垒起点）

* 自动标红 v0.1 + 一键修正标签

---

## 11. 设计时的检查清单（你画 UI 时对照）

* [ ] 导入 GPX 后 10 秒内能进入回放
* [ ] 工作台布局清晰：Canvas / Timeline / Charts / Events
* [ ] 图表点击能跳转回放
* [ ] 事件标注极快（≤2 次点击 + 输入）
* [ ] 分享/导出路径不绕
* [ ] 数据隐私默认私有 + opt-in 清晰

---

## 12. 一句话 MVP 指导原则

> **MVP 不追求“自动教练”，只追求“让教练更快讲清楚”。**

做到了这点，你的硬件数据、语义引擎、风场重建都会自然接上。


